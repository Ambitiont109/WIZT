(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1822:function(t,e,a){"use strict";a.r(e);var n=a(7),c=a(8),r=a(13),o=a(12),i=a(14),s=a(0),l=a.n(s),u=a(43),p=a(10),d=a(22),m=a(93),f=a(23),h=a(172),C=a(6),g=a(1),O=a(491),b=a(38),T=a.n(b),E="[CONTACTS APP] GET USER DATA";function y(){var t=T.a.get("/api/contacts-app/user");return function(e){return t.then(function(t){return e({type:E,payload:t.data})})}}var A=a(64),v="[CONTACTS APP] GET CONTACTS",N="[CONTACTS APP] SET SEARCH TEXT",P="[CONTACTS APP] TOGGLE IN SELECTED CONTACTS",S="[CONTACTS APP] SELECT ALL CONTACTS",j="[CONTACTS APP] DESELECT ALL CONTACTS",D="[CONTACTS APP] OPEN NEW CONTACT DIALOG",w="[CONTACTS APP] CLOSE NEW CONTACT DIALOG",x="[CONTACTS APP] OPEN EDIT CONTACT DIALOG",I="[CONTACTS APP] CLOSE EDIT CONTACT DIALOG",L="[CONTACTS APP] ADD CONTACT",k="[CONTACTS APP] UPDATE CONTACT",M="[CONTACTS APP] REMOVE CONTACTS",R="[CONTACTS APP] TOGGLE STARRED CONTACT",G="[CONTACTS APP] TOGGLE STARRED CONTACTS",U="[CONTACTS APP] SET CONTACTS STARRED ",F="[CONTACTS APP] OPEN CONFIRM DIALOG",z="[CONTACTS APP] CLOSE CONFIRM DIALOG";function H(t){var e=T.a.get(A.a.baseUrl+"/admin/notifications/",{params:t});return function(a){return e.then(function(e){return a({type:v,payload:e.data.results,totalPage:e.data.count,params:t})})}}function W(t){return{type:N,searchText:t.target.value}}function _(t){return{type:P,contactId:t}}function q(){return{type:S}}function B(){return{type:j}}function J(){return{type:D}}function X(){return{type:w}}function Y(t){return{type:x,data:t}}function V(){return{type:I}}function K(t){return function(e,a){var n=a().contactsApp.contacts.routeParams;return T.a.post("/api/contacts-app/add-contact",{newContact:t}).then(function(t){return Promise.all([e({type:L})]).then(function(){return e(H(n))})})}}function Q(t){return function(e,a){var n=a().contactsApp.contacts.routeParams;return T.a.post("/api/contacts-app/update-contact",{contact:t}).then(function(t){return Promise.all([e({type:k})]).then(function(){return e(H(n))})})}}function Z(t){return T.a.delete(A.a.baseUrl+"/admin/notifications/"+t+"/"),{type:null}}function $(t){return{type:F,data:t}}function tt(){return{type:z}}function et(t){return function(e,a){var n=a().contactsApp.contacts.routeParams;return T.a.post("/api/contacts-app/remove-contacts",{contactIds:t}).then(function(t){return Promise.all([e({type:M}),e({type:j})]).then(function(){return e(H(n))})})}}function at(t){return function(e,a){var n=a().contactsApp.contacts.routeParams;return T.a.post("/api/contacts-app/toggle-starred-contact",{contactId:t}).then(function(t){return Promise.all([e({type:R}),e(y())]).then(function(){return e(H(n))})})}}function nt(t){return function(e,a){var n=a().contactsApp.contacts.routeParams;return T.a.post("/api/contacts-app/toggle-starred-contacts",{contactIds:t}).then(function(t){return Promise.all([e({type:G}),e({type:j}),e(y())]).then(function(){return e(H(n))})})}}function ct(t){return function(e,a){var n=a().contactsApp.contacts.routeParams;return T.a.post("/api/contacts-app/set-contacts-starred",{contactIds:t}).then(function(t){return Promise.all([e({type:U}),e({type:j}),e(y())]).then(function(){return e(H(n))})})}}function rt(t){return function(e,a){var n=a().contactsApp.contacts.routeParams;return T.a.post("/api/contacts-app/set-contacts-unstarred",{contactIds:t}).then(function(t){return Promise.all([e({type:U}),e({type:j}),e(y())]).then(function(){return e(H(n))})})}}var ot=function(t){function e(){var t;return Object(n.a)(this,e),(t=Object(r.a)(this,Object(o.a)(e).call(this))).state={selectedContactsMenu:null},t.getFilteredArray=function(t,e){var a=Object.keys(t).map(function(e){return t[e]});return 0===e.length?a:p.t.filterArrayByString(a,e)},t.openSelectedContactMenu=function(e){t.setState({selectedContactsMenu:e.currentTarget})},t.closeSelectedContactsMenu=function(){t.setState({selectedContactsMenu:null})},t.dateFormat=function(t){var e=new Date(t);return e=e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()+" "+(e.getHours()>12?e.getHours()-12:e.getHours())+":"+e.getMinutes()+" "+(e.getHours()>=12?"PM":"AM"),l.a.createElement("div",null,e)},t.fetchData=function(e){t.setState({pageSize:e.pageSize}),T.a.post(A.a.baseUrl+"/admin/notifications/pagination/",{pagination_size:e.pageSize});var a={page:""};0===e.page?(a.page=1,t.props.getContacts(a)):(a={page:e.page+1},t.props.getContacts(a))},t.state={pageSize:""},t}return Object(i.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this,e=this.state.pageSize,a=this.props,n=a.contacts,c=a.page,r=a.searchText,o=a.confirmDialog,i=a.totalPage,s=this.getFilteredArray(n,r),u=Math.floor(i/e);if(u&&i%e&&u++,c)var d=c.page-1;else d=0;return s||0!==s.length?l.a.createElement(p.b,{animation:"transition.slideUpIn",delay:300},l.a.createElement(O.b,{className:"-striped -highlight border-0",data:s,columns:[{Header:"No",headerClassName:"h-52 text-16",accessor:"no",filterable:!1,Cell:function(e){return l.a.createElement("span",null,e.index+1+t.state.pageSize*d)},width:64,className:"justify-center"},{Header:"Message",accessor:"message",filterable:!1,sortable:!1},{Header:"Created at",accessor:"created_at",filterable:!1,sortable:!1,Cell:function(e){return t.dateFormat(e.value)}},{Header:"",width:64,Cell:function(t){return l.a.createElement("div",{className:"flex items-center"},l.a.createElement(g.x,{onClick:function(e){e.stopPropagation(),o(t.original.id)}},l.a.createElement(g.w,null,"delete")))},className:"justify-center"}],pages:u,manual:!0,onFetchData:this.fetchData,defaultPageSize:10,noDataText:"No contacts found"})):l.a.createElement("div",{className:"flex items-center justify-center h-full"},l.a.createElement(g.ab,{color:"textSecondary",variant:"h5"},"There are no contacts!"))}}]),e}(s.Component);var it=Object(m.g)(Object(f.b)(function(t){var e=t.NotificationsApp;return{contacts:e.contacts.entities,totalPage:e.contacts.totalPage,page:e.contacts.page,selectedContactIds:e.contacts.selectedContactIds,searchText:e.contacts.searchText,user:e.user}},function(t){return Object(d.c)({getContacts:H,getUserData:y,toggleInSelectedContacts:_,selectAllContacts:q,deSelectAllContacts:B,openEditContactDialog:Y,removeContacts:et,removeContact:Z,toggleStarredContact:at,toggleStarredContacts:nt,setContactsStarred:ct,setContactsUnstarred:rt,confirmDialog:$},t)})(ot)),st=function(t){function e(){var t,a;Object(n.a)(this,e);for(var c=arguments.length,i=new Array(c),s=0;s<c;s++)i[s]=arguments[s];return(a=Object(r.a)(this,(t=Object(o.a)(e)).call.apply(t,[this].concat(i)))).addNote=function(){a.props.history.push({pathname:"/admin/plans/note/"})},a}return Object(i.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this,e=this.props,a=e.setSearchText,n=e.searchText,c=e.pageLayout,r=e.mainTheme;return l.a.createElement("div",{className:"flex flex-1 items-center justify-between p-8 sm:p-24"},l.a.createElement("div",{className:"flex flex-shrink items-center sm:w-224"},l.a.createElement(g.v,{lgUp:!0},l.a.createElement(g.x,{onClick:function(t){return c().toggleLeftSidebar()},"aria-label":"open left sidebar"},l.a.createElement(g.w,null,"menu"))),l.a.createElement("div",{className:"flex items-center"},l.a.createElement(p.b,{animation:"transition.expandIn",delay:300},l.a.createElement(g.w,{className:"text-32 mr-12"},"notifications")),l.a.createElement(p.b,{animation:"transition.slideLeftIn",delay:300},l.a.createElement(g.ab,{variant:"h6",className:"hidden sm:flex"},"Notifications")))),l.a.createElement("div",{className:"flex flex-1 items-center justify-center pr-8 sm:px-12"},l.a.createElement(u.MuiThemeProvider,{theme:r},l.a.createElement(p.b,{animation:"transition.slideLeftIn",delay:300},l.a.createElement(g.L,{className:"flex p-4 items-center w-full max-w-512 px-8 py-4",elevation:1},l.a.createElement(g.w,{className:"mr-8",color:"action"},"search"),l.a.createElement(g.y,{placeholder:"Search for anything",className:"flex flex-1",disableUnderline:!0,fullWidth:!0,value:n,inputProps:{"aria-label":"Search"},onChange:a}))))),l.a.createElement("div",{style:{marginRight:20}},l.a.createElement(g.c,{onClick:function(e){e.preventDefault(),t.addNote()}},l.a.createElement(g.w,null,"add_circle"),l.a.createElement(g.ab,{style:{marginLeft:4}},"new"))))}}]),e}(s.Component);var lt=Object(m.g)(Object(f.b)(function(t){var e=t.NotificationsApp,a=t.fuse;return{searchText:e.contacts.searchText,mainTheme:a.settings.mainTheme}},function(t){return Object(d.c)({setSearchText:W,openNewContactDialog:J},t)})(st)),ut=a(65),pt=a.n(ut),dt=a(249),mt=a.n(dt),ft=a(250),ht=a.n(ft),Ct=a(251),gt=a.n(Ct),Ot=a(253),bt=a.n(Ot),Tt=a(252),Et=a.n(Tt),yt=function(t){function e(){var t,a;Object(n.a)(this,e);for(var c=arguments.length,i=new Array(c),s=0;s<c;s++)i[s]=arguments[s];return(a=Object(r.a)(this,(t=Object(o.a)(e)).call.apply(t,[this].concat(i)))).state={open:!1},a.handleClickOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1})},a.removeContact=function(t){T.a.delete(A.a.baseUrl+"/admin/notifications/"+t+"/").then(function(t){return a.ReturnMainPage()})},a.ReturnMainPage=function(){var t=a.props,e=t.history,n=t.page;e.push({pathname:"/admin/notifications",page:n}),a.props.closeConfirmDialog()},a}return Object(i.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this,e=this.props,a=e.closeConfirmDialog,n=e.confirmDialog;return l.a.createElement(mt.a,{open:n.props.open,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},l.a.createElement(Et.a,{id:"alert-dialog-title"},"Permanently delete?"),l.a.createElement(gt.a,null,l.a.createElement(bt.a,{id:"alert-dialog-description"},"Please note that it will delete all the user data.")),l.a.createElement(ht.a,null,l.a.createElement(pt.a,{onClick:function(){t.removeContact(n.user_id)},color:"primary",autoFocus:!0},"Agree"),l.a.createElement(pt.a,{onClick:function(){a()},color:"primary"},"Disagree")))}}]),e}(l.a.Component);var At=Object(f.b)(function(t){var e=t.NotificationsApp;return{confirmDialog:e.contacts.confirmDialog,page:e.contacts.page}},function(t){return Object(d.c)({closeEditContactDialog:V,closeNewContactDialog:X,addContact:K,updateContact:Q,closeConfirmDialog:tt},t)})(yt),vt=a(16),Nt={id:"",name:"",lastName:"",avatar:"assets/images/avatars/profile.jpg",nickname:"",company:"",jobTitle:"",email:"",phone:"",address:"",birthday:"",notes:""},Pt=function(t){function e(){var t,a;Object(n.a)(this,e);for(var c=arguments.length,i=new Array(c),s=0;s<c;s++)i[s]=arguments[s];return(a=Object(r.a)(this,(t=Object(o.a)(e)).call.apply(t,[this].concat(i)))).state=Object(vt.a)({},Nt),a.handleChange=function(t){a.setState(C.a.set(Object(vt.a)({},a.state),t.target.name,"checkbox"===t.target.type?t.target.checked:t.target.value))},a.closeComposeDialog=function(){"edit"===a.props.contactDialog.type?a.props.closeEditContactDialog():a.props.closeNewContactDialog()},a}return Object(i.a)(e,t),Object(c.a)(e,[{key:"componentDidUpdate",value:function(t,e){!t.contactDialog.props.open&&this.props.contactDialog.props.open&&("edit"===this.props.contactDialog.type&&this.props.contactDialog.data&&!C.a.isEqual(this.props.contactDialog.data,e)&&this.setState(Object(vt.a)({},this.props.contactDialog.data)),"new"!==this.props.contactDialog.type||C.a.isEqual(Nt,e)||this.setState(Object(vt.a)({},Nt)))}},{key:"canBeSubmitted",value:function(){return this.state.name.length>0}},{key:"render",value:function(){var t=this,e=this.props.contactDialog;return l.a.createElement(g.j,Object.assign({classes:{paper:"m-24"}},e.props,{onClose:this.closeComposeDialog,fullWidth:!0,maxWidth:"xs"}),l.a.createElement(g.a,{position:"static",elevation:1},l.a.createElement(g.Y,{className:"flex w-full"},l.a.createElement(g.ab,{variant:"subtitle1",color:"inherit"},"new"===e.type?"New Contact":"Edit Contact")),l.a.createElement("div",{className:"flex flex-col items-center justify-center pb-24"},l.a.createElement(g.b,{className:"w-96 h-96",alt:"contact avatar",src:this.state.avatar}),"edit"===e.type&&l.a.createElement(g.ab,{variant:"h6",color:"inherit",className:"pt-8"},this.state.name))),l.a.createElement(g.l,{classes:{root:"p-24"}},l.a.createElement("div",{className:"flex"},l.a.createElement("div",{className:"min-w-48 pt-20"},l.a.createElement(g.w,{color:"action"},"note")),l.a.createElement(g.X,{className:"mb-24",label:"Notes",id:"notes",name:"notes",value:this.state.notes,onChange:this.handleChange,variant:"outlined",multiline:!0,rows:5,fullWidth:!0}))),"new"===e.type?l.a.createElement(g.k,{className:"justify-between pl-16"},l.a.createElement(g.c,{variant:"contained",color:"primary"},"Send")):l.a.createElement(g.k,{className:"justify-end pl-16"},l.a.createElement(g.c,{variant:"contained",color:"primary",onClick:function(){t.closeComposeDialog()}},"Send")))}}]),e}(s.Component);var St=Object(f.b)(function(t){return{contactDialog:t.NotificationsApp.contacts.contactDialog}},function(t){return Object(d.c)({closeEditContactDialog:V,closeNewContactDialog:X,addContact:K,updateContact:Q,removeContact:Z},t)})(Pt),jt=a(24),Dt=a(21),wt={entities:[],page:"",totalPage:"",searchText:"",selectedContactIds:[],routeParams:{},contactDialog:{type:"new",props:{open:!1},data:null},confirmDialog:{props:{open:!1},user_id:null}},xt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case v:return Object(vt.a)({},t,Object(Dt.a)({entities:e.payload,page:e.params,totalPage:e.totalPage},"page",e.params));case N:return Object(vt.a)({},t,{searchText:e.searchText});case P:var a=e.contactId,n=Object(jt.a)(t.selectedContactIds);return n=void 0!==n.find(function(t){return t===a})?n.filter(function(t){return t!==a}):Object(jt.a)(n).concat([a]),Object(vt.a)({},t,{selectedContactIds:n});case S:var c=Object.keys(t.entities).map(function(e){return t.entities[e]}).map(function(t){return t.id});return Object(vt.a)({},t,{selectedContactIds:c});case j:return Object(vt.a)({},t,{selectedContactIds:[]});case"[CONTACTS APP] OPEN CONFIRM DIALOG":return Object(vt.a)({},t,{confirmDialog:{props:{open:!0},user_id:e.data}});case"[CONTACTS APP] CLOSE CONFIRM DIALOG":return Object(vt.a)({},t,{confirmDialog:{props:{open:!1},user_id:null}});case D:return Object(vt.a)({},t,{contactDialog:{type:"new",props:{open:!0},data:null}});case w:return Object(vt.a)({},t,{contactDialog:{type:"new",props:{open:!1},data:null}});case x:return Object(vt.a)({},t,{contactDialog:{type:"edit",props:{open:!0},data:e.data}});case I:return Object(vt.a)({},t,{contactDialog:{type:"edit",props:{open:!1},data:null}});default:return t}},It=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case E:return e.payload;default:return t}},Lt=Object(d.d)({contacts:xt,user:It}),kt=function(t){function e(){return Object(n.a)(this,e),Object(r.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(i.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){this.props.getUserData()}},{key:"componentDidUpdate",value:function(t){C.a.isEqual(this.props.location,t.location)||this.props.getContacts(this.props.location.page)}},{key:"render",value:function(){var t=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(p.m,{classes:{contentCardWrapper:"p-16 sm:p-24 pb-80",leftSidebar:"w-256 border-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:l.a.createElement(lt,{pageLayout:function(){return t.pageLayout}}),content:l.a.createElement(it,null),sidebarInner:!0,onRef:function(e){t.pageLayout=e},innerScroll:!0}),l.a.createElement(St,null),l.a.createElement(At,{history:this.props.history}))}}]),e}(s.Component);e.default=Object(h.a)("NotificationsApp",Lt)(Object(u.withStyles)(function(t){return{addButton:{position:"absolute",right:12,bottom:12,zIndex:99}}},{withTheme:!0})(Object(m.g)(Object(f.b)(function(t){var e=t.NotificationsApp;return{contacts:e.contacts.entities,selectedContactIds:e.contacts.selectedContactIds,searchText:e.contacts.searchText,user:e.user}},function(t){return Object(d.c)({getContacts:H,getUserData:y,openNewContactDialog:J},t)})(kt))))}}]);